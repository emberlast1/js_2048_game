const t=new class{constructor(t=this.createEmptyBoard()){this.board=t,this.score=0,this.status="idle"}createEmptyBoard(){return[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}moveLeft(){let t=!1;for(let e=0;e<4;e++){let s=this.board[e].filter(t=>t);for(;s.length<4;)s.push(0);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,s[t+1]=0,this.score+=s[t]);for(s=s.filter(t=>t);s.length<4;)s.push(0);this.board[e].join()!==s.join()&&(this.board[e]=s,t=!0)}t&&(this.addRandomTile(),this.gameStatus())}moveRight(){let t=!1;for(let e=0;e<4;e++){let s=this.board[e].filter(t=>t).reverse();for(;s.length<4;)s.push(0);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,s[t+1]=0,this.score+=s[t]);for(s=s.filter(t=>t).reverse();s.length<4;)s.unshift(0);this.board[e].join()!==s.join()&&(this.board[e]=s,t=!0)}t&&(this.addRandomTile(),this.gameStatus())}moveUp(){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.board[t][e]&&s.push(this.board[t][e]);for(;s.length<4;)s.push(0);for(let t=0;t<s.length;t++)s[t]===s[t+1]&&(s[t]*=2,s[t+1]=0,this.score+=s[t]);for(s=s.filter(t=>t);s.length<4;)s.push(0);for(let r=0;r<4;r++)this.board[r][e]!==s[r]&&(t=!0),this.board[r][e]=s[r]}t&&(this.addRandomTile(),this.gameStatus())}moveDown(){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.board[t][e]&&s.push(this.board[t][e]);for(;s.length<4;)s.unshift(0);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]*=2,s[t-1]=0,this.score+=s[t]);for(s=s.filter(t=>t);s.length<4;)s.unshift(0);for(let r=0;r<4;r++)this.board[r][e]!==s[r]&&(t=!0),this.board[r][e]=s[r]}t&&(this.addRandomTile(),this.gameStatus())}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.board=this.createEmptyBoard(),this.score=0,this.status="idle"}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,cell:s});if(t.length>0){let{row:e,cell:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}gameStatus(){for(let t of this.board)if(t.includes(2048)){this.status="win";return}for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||t>0&&this.board[t][e]===this.board[t-1][e]||e>0&&this.board[t][e]===this.board[t][e-1])return;this.status="lose"}},e=document.querySelector(".button"),s=document.querySelector(".message-start"),r=document.querySelector(".message-lose"),o=document.querySelector(".message-lose");function a(t){let e=document.querySelector(".game-field").querySelectorAll(".field-cell"),s=document.querySelector(".game-score"),a=t.getState();for(let t=0;t<4;t++)for(let s=0;s<4;s++){let r=e[4*t+s],o=a[t][s];r.classList=`field-cell field-cell--${o}`,r.textContent=0===o?"":o,0===o&&(r.classList="field-cell")}s.textContent=t.getScore(),"win"===t.getStatus()?o.classList.remove("hidden"):"lose"===t.getStatus()?r.classList.remove("hidden"):(o.classList.add("hidden"),r.classList.add("hidden"))}e.addEventListener("click",()=>{e.classList.contains("start")?(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",s.classList.add("hidden"),t.start()):e.classList.contains("restart")&&(e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",s.classList.remove("hidden"),t.restart()),a(t)}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}a(t)}});
//# sourceMappingURL=index.7e2c9175.js.map
